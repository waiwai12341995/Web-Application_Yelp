{"filter":false,"title":"comments.js","tooltip":"/YelpCamp/v7/routes/comments.js","undoManager":{"mark":10,"position":10,"stack":[[{"start":{"row":0,"column":0},"end":{"row":38,"column":0},"action":"insert","lines":["","// ==========================================","// Comment Routes","//===========================================","","app.get(\"/campgrounds/:id/comments/new\", isLogin, function(req, res) {","    // find campground by id","    Campground.findById(req.params.id, function(err, campground){","        if(err){","            console.log(err);","        }else{","            res.render(\"comments/new\", {campground: campground});","        }","    })","});","","app.post(\"/campgrounds/:id/comments\", isLogin, function(req, res) {","    //lookup campground using id","    Campground.findById(req.params.id, function(err, campground){","        if(err){","            console.log(err);","            res.redirect(\"/campgrounds\");","        }else{","            //create new comment","            Comment.create(req.body.comment, function(err, comment){","                if(err){","                    console.log(err);","                }else{","                    //connect new comment to campground","                    campground.comments.push(comment)","                    campground.save();","                    //redirect to campground show page       ","                    res.redirect(\"/campgrounds/\"+campground._id);","                }","            })","        }","    })","});",""],"id":1}],[{"start":{"row":38,"column":0},"end":{"row":39,"column":0},"action":"insert","lines":["",""],"id":2},{"start":{"row":39,"column":0},"end":{"row":40,"column":0},"action":"insert","lines":["",""]}],[{"start":{"row":40,"column":0},"end":{"row":41,"column":0},"action":"insert","lines":["module.exports = router;",""],"id":3}],[{"start":{"row":40,"column":24},"end":{"row":41,"column":0},"action":"remove","lines":["",""],"id":4}],[{"start":{"row":0,"column":0},"end":{"row":1,"column":0},"action":"insert","lines":["",""],"id":5},{"start":{"row":1,"column":0},"end":{"row":2,"column":0},"action":"insert","lines":["",""]}],[{"start":{"row":0,"column":0},"end":{"row":3,"column":42},"action":"insert","lines":["var express = require(\"express\");","var router = express.Router();","var Campground = require(\"../models/campground\")","var Comment = require(\"../models/comment\")"],"id":6}],[{"start":{"row":42,"column":3},"end":{"row":43,"column":0},"action":"insert","lines":["",""],"id":7},{"start":{"row":43,"column":0},"end":{"row":44,"column":0},"action":"insert","lines":["",""]}],[{"start":{"row":44,"column":0},"end":{"row":49,"column":1},"action":"insert","lines":["function isLogin(req, res, next){","    if(req.isAuthenticated()){","        return next();","    }","    res.redirect(\"/login\")","}"],"id":8}],[{"start":{"row":49,"column":1},"end":{"row":50,"column":0},"action":"remove","lines":["",""],"id":9}],[{"start":{"row":10,"column":0},"end":{"row":10,"column":3},"action":"remove","lines":["app"],"id":10},{"start":{"row":10,"column":0},"end":{"row":10,"column":6},"action":"insert","lines":["router"]}],[{"start":{"row":21,"column":0},"end":{"row":21,"column":3},"action":"remove","lines":["app"],"id":11},{"start":{"row":21,"column":0},"end":{"row":21,"column":6},"action":"insert","lines":["router"]}]]},"ace":{"folds":[],"scrolltop":532.5,"scrollleft":0,"selection":{"start":{"row":4,"column":0},"end":{"row":4,"column":0},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":295,"mode":"ace/mode/javascript"}},"timestamp":1547442570329,"hash":"dd055efc6c176891f1aa30731c3ee2c5979d90e0"}